------- Consultation -------



select * from CLUBS;
//////////////
select * from EQUIPES;
//////////////
select * from JOUEURS;
//////////////

select R.DATE_DE_RENCONTRE,E1.NOM_EQUIPE as EQUIPE_ACCEUILLANTE,R.SCORE_EQUIPE_ACCEUILLANTE,E2.NOM_EQUIPE as EQUIPE_RECUS,R.SCORE_EQUIPE_RECUE 
    from RENCONTRES R, EQUIPES E1, EQUIPES E2
    where E1.NUMERO_EQUIPE  = R.NUMERO_EQUIPE_ACCEUILLANTE and E2.NUMERO_EQUIPE  = R.NUMERO_EQUIPE_RECUS 
    group by 1; 

//////////////

select R.DATE_DE_RENCONTRE, J.NOM_JOUEUR as NOM, J.PRENOM_JOUEUR as PRENOM
    from JOUEURS J, PARTICIPER P,RENCONTRES R 
    where R.NUMERO_DE_RENCONTRE = P.NUMERO_RENCONTRE and P.NUMERO_DE_LICENSE = J.NUMERO_DE_LICENSE
    group by 1;
//////////////
create view T1 (NUMERO_DE_RENCONTRE,DATE_DE_RENCONTRE,EQUIPE_ACCEUILLANTE,NOM,PRENOM,BUTS,FAUTES,SCORE)
as select  R.NUMERO_DE_RENCONTRE,
        R.DATE_DE_RENCONTRE,
        E.NOM_EQUIPE,
        J.NOM_JOUEUR,
        J.PRENOM_JOUEUR,
        P.NOMBRE_POINTS_MARQUES,
        P.NOMBRE_FAUTES_COMMISES,
        R.SCORE_EQUIPE_ACCEUILLANTE
        
        from RENCONTRES R, EQUIPES E, PARTICIPER P, JOUEURS J
        where R.NUMERO_EQUIPE_ACCEUILLANTE = E.NUMERO_EQUIPE
            and R.NUMERO_DE_RENCONTRE = P.NUMERO_RENCONTRE
            and P.NUMERO_DE_LICENSE = J.NUMERO_DE_LICENSE
        ;
        

create view T2 (NUMERO_DE_RENCONTRE,DATE_DE_RENCONTRE,EQUIPE_RECUS,NOM,PRENOM,BUTS,FAUTES,SCORE)
select  R.NUMERO_DE_RENCONTRE,
        R.DATE_DE_RENCONTRE,
        E.NOM_EQUIPE,
        J.NOM_JOUEUR,
        J.PRENOM_JOUEUR,
        P.NOMBRE_POINTS_MARQUES,
        P.NOMBRE_FAUTES_COMMISES,
        R.SCORE_EQUIPE_RECUS
        
        from RENCONTRES R, EQUIPES E, PARTICIPER P, JOUEURS J
        where R.NUMERO_EQUIPE_RECUS = E.NUMERO_EQUIPE
            and R.NUMERO_DE_RENCONTRE = P.NUMERO_RENCONTRE
            and P.NUMERO_DE_LICENSE = J.NUMERO_DE_LICENSE
        ;

select * from T1 , T2 where T1.NUMERO_DE_RENCONTRE = T2.NUMERO_DE_RENCONTRE ;
//////////////

% nbre matches gagnes
select E.NUMERO_EQUIPE , count(*) as MATCHS_GAGNE 
    from EQUIPES E, RENCONTRES R 
    where (E.NUMERO_EQUIPE = R.NUMERO_EQUIPE_ACCEUILLANTE and R.SCORE_EQUIPE_ACCEUILLANTE > R.SCORE_EQUIPE_RECU) 
        or (E.NUMERO_EQUIPE = R.NUMERO_EQUIPE_RECU and R.SCORE_EQUIPE_RECUS > R.SCORE_EQUIPE_ACCEUILLANTE)
    ; 

% nbre matches perdues
select E.NUMERO_EQUIPE , count(*) as MATCHS_GAGNE 
    from EQUIPES E, RENCONTRES R 
    where (E.NUMERO_EQUIPE = R.NUMERO_EQUIPE_ACCEUILLANTE and R.SCORE_EQUIPE_ACCEUILLANTE < R.SCORE_EQUIPE_RECU) 
        or (E.NUMERO_EQUIPE = R.NUMERO_EQUIPE_RECU and R.SCORE_EQUIPE_RECUS < R.SCORE_EQUIPE_ACCEUILLANTE)
    ;

%nbre de matches nuls
select E.NUMERO_EQUIPE , count(*) as MATCHS_GAGNE 
    from EQUIPES E, RENCONTRES R 
    where (E.NUMERO_EQUIPE = R.NUMERO_EQUIPE_ACCEUILLANTE and R.SCORE_EQUIPE_ACCEUILLANTE = R.SCORE_EQUIPE_RECU)
    ;
-------- Statistques --------





